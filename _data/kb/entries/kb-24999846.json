{
  "Document": {
    "DocumentId": -24999846,
    "Title": "Code: Passing Data between SQL And Access Tables",
    "DocumentShortName": null,
    "FileName": null,
    "Path": null,
    "CreateDate": "1999-09-09T15:25:59",
    "ModificationDate": "1999-09-09T15:25:59",
    "TemplateId": null,
    "SegmentId": 63,
    "IsRoot": false,
    "IsActive": true,
    "SortOrdinal": null,
    "ClientId": null,
    "Tag": null
  },
  "Content": "I have had problems using stored delete/update queries that involve changing data in SQL tables. The query would run without returning any error. It would also indicate SQL table rows have been deleted or changed. But when the SQL table is re-opened the records would reappear or revert to their original state.\n\nTo avoid this issue entirely I have  written code that uses DAO objects instead of stored queries (other than SELECT queries). The following is a sketch of this technique:\n\nModule Level:\n'\n'NOTE: This procedure contains line break characters\n'for readability. These characters are not supported\n'in Access Basic.\n'\nOption Compare Database   'Use database order for string comparisons\nOption Explicit\n\nDim m_wsDAO As WorkSpace\nDim m_dbDAO As Database\n\nDim m_varReturn As Variant\nDim m_Transaction As Integer\nDim m_intObj As Integer\n\nDim m_strMsgBox  As String, m_strFileName As String\n\nSub DailyCalc_CleanSQLtbls ()\n    '\n    'This sub clears out temporary Shaw CUSIPs from SQL Server\n    'tables ejv_cusip and output_oas. Without this procedure\n    'duplicate Security Names can show up\n    'in qselPortfolio* queries.\n    '\n    Dim dbSQLServer As Database, rsDAO As Recordset\n    Dim tSQL As String\n\n    On Error GoTo DailyCalc_CleanSQLtbls_Err\n\n    m_intObj = m_wsDAO Is Nothing\n    If m_intObj Then\n        MsgBox \"This sub needs workspace and database objects!\"\n        Exit Sub\n    End If\n\n    m_intObj = m_dbDAO Is Nothing\n    If m_intObj Then\n        MsgBox \"This sub needs a database object!\"\n        Exit Sub\n    End If\n    \n    Set dbSQLServer = m_wsDAO.OpenDatabase(\"\", _\n        False, False, ODBC_CONNECT_STRING)\n    Set rsDAO = m_dbDAO.OpenRecordset(\"qselOA_not_Taz\", _\n        DB_OPEN_DYNASET, DB_READONLY)\n    \n    While Not rsDAO.EOF\n\n        tSQL = \"delete from ejv_cusip \"\n        tSQL = tSQL & \"where cusip = '\" & rsDAO(\"cusip\") & \"'\"\n\n        dbSQLServer.Execute tSQL, DB_SQLPASSTHROUGH\n\n        rsDAO.MoveNext\n    Wend\n\n    Set rsDAO = m_dbDAO.OpenRecordset(\"qselOA_not_Taz\", _\n        DB_OPEN_DYNASET, DB_READONLY)\n\n    While Not rsDAO.EOF\n\n        tSQL = \"delete from output_oas \"\n        tSQL = tSQL & \"where cusip = '\" & rsDAO(\"cusip\") & \"'\"\n\n        dbSQLServer.Execute tSQL, DB_SQLPASSTHROUGH\n\n        rsDAO.MoveNext\n    Wend\n    \nDailyCalc_CleanSQLtbls_Exit:\n    m_intObj = dbSQLServer Is Nothing\n    If Not (m_intObj) Then dbSQLServer.Close\n    Exit Sub\n\nDailyCalc_CleanSQLtbls_Err:\n    Select Case Err\n        Case Else\n            MsgBox Err & \": \" & Error$(Err), 16, _\n                \"DailyCalc_CleanSQLtbls Error\"\n            Resume DailyCalc_CleanSQLtbls_Exit\n\n    End Select\nEnd Sub",
  "Tag": "kb-24999846"
}