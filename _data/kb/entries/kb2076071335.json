{
  "Document": {
    "DocumentId": 2076071335,
    "Title": "Windows 2000: Code; Windows Scripting Host; WSH; an FTP Script That PUTs Data from ADO",
    "DocumentShortName": null,
    "FileName": null,
    "Path": null,
    "CreateDate": "2001-02-06T16:47:45.62",
    "ModificationDate": "2001-02-06T16:47:45.62",
    "TemplateId": null,
    "SegmentId": 79,
    "IsRoot": false,
    "IsActive": true,
    "SortOrdinal": null,
    "ClientId": null,
    "Tag": null
  },
  "Content": "'I wrote this script (Go2FTP.scr) for an entertainment company.\n'This is a quick hack since they were not concerned about high security.\n\nDim objShell\nDim objFileSys\nDim objOutStream\nDim strCnn\nDim strWrite\nDim cnnADO\nDim rsADO\n    \nstrCnn = \"Provider=SQLOLEDB.1;\" _\n    & \"Password=unsecured1;\" _\n    & \"Persist Security Info=False;\" _\n    & \"User ID=rasx;\" _\n    & \"Initial Catalog=Schedule;\" _\n    & \"Data Source=DB2HACK;\"\n\nSet cnnADO = WScript.CreateObject(\"ADODB.Connection\")\ncnnADO.ConnectionString = strCnn\ncnnADO.Open\nSet rsADO = cnnADO.Execute(\"EXECUTE ListGo2Events\", , adCmdText)\n\nSet objFileSys = WScript.CreateObject(\"Scripting.FileSystemObject\")\nSet objOutStream = objFileSys.CreateTextFile(\"C:\\Go2FTP.txt\")\n\nDo While Not rsADO.EOF\n    strWrite = rsADO.Fields(\"EventID\") _\n        & \"|\" & rsADO.Fields(\"ArtistSummary\") _\n        & \"|\" & rsADO.Fields(\"ArtistExtended\") _\n        & \"|\" & rsADO.Fields(\"VenueID\") _\n        & \"|\" & rsADO.Fields(\"DoorDate\") _\n        & \"|\" & rsADO.Fields(\"DoorTime\") _\n        & \"|\" & rsADO.Fields(\"EventDate\") _\n        & \"|\" & rsADO.Fields(\"EventTime\") _\n        & \"|\" & rsADO.Fields(\"GenreID\") _\n        & \"|\" & rsADO.Fields(\"genre_name\") _\n        & \"|\" & rsADO.Fields(\"AgeRestriction\") _\n        & \"|\" & rsADO.Fields(\"SoldOutIndicator\") _\n        & \"|\" & rsADO.Fields(\"ChangedToDate\") _\n        & \"|\" & rsADO.Fields(\"ChangedToTime\") _\n        & \"|\" & rsADO.Fields(\"Canceled\")\n    Call objOutStream.WriteLine(strWrite)\n    rsADO.MoveNext\nLoop\n\nrsADO.Close\ncnnADO.Close\n\nSet rsADO = Nothing\nSet cnnADO = Nothing\n\nSet objShell = WScript.CreateObject(\"WScript.Shell\")\nCall objShell.Run(\"ftp -n -s:Go2FTP.scr.txt\")\nSet objShell = Nothing\n\n\n'Note that Go2FTP.scr.txt contains the following:\n'    open 127.0.0.1\n'    user ftploser $pass$word\n'    ascii\n'    put C:\\Go2FTP.txt\n'    close\n'    open 127.0.0.2\n'    user ftploser $pass$word\n'    ascii\n'    put C:\\Go2FTP.txt\n'    bye",
  "Tag": "kb2076071335"
}