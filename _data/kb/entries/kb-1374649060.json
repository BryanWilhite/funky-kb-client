{
  "Document": {
    "DocumentId": -1374649060,
    "Title": "Code: basMessagingLink",
    "DocumentShortName": null,
    "FileName": null,
    "Path": null,
    "CreateDate": "1999-09-09T16:02:14",
    "ModificationDate": "1999-09-09T16:02:14",
    "TemplateId": null,
    "SegmentId": 64,
    "IsRoot": false,
    "IsActive": true,
    "SortOrdinal": null,
    "ClientId": null,
    "Tag": null
  },
  "Content": "Public Sub basMessagingLink(Optional IsAddressBook = False)\n\n    Dim tdfDAO As TableDef\n    Dim strConn As String\n\n    g_strMsg = \"Are you sure?\" & vbCrLf _\n        & \"TIP: Outlook Express should not \" _\n        & \"be your default MAPI client \" _\n        & \"during this procedure. (In Outlook Express, \" _\n        & \"see Options > General.)\"\n    If VBA.MsgBox(g_strMsg, vbQuestion + vbYesNo _\n        + vbDefaultButton2, _\n        \"Songhay System\") = vbNo Then Exit Sub\n    \n    On Error GoTo basMessagingLink_Err\n    \n    If VBA.VarType(IsAddressBook) <> vbBoolean Then _\n        If VBA.VarType(IsAddressBook) <> vbInteger Then _\n            VBA.Err.Raise 450\n    \n    'Source database type:\n    strConn = \"Exchange 4.0;\"\n    'Table name (MAPILEVEL=<storage|folders>):\n    strConn = strConn & \"MAPILEVEL=Personal Folders|;\"\n    'Source table type (0 for folders, 1 for address books):\n    If IsAddressBook Then\n        strConn = strConn & \"TABLETYPE=1;\"\n    Else\n        strConn = strConn & \"TABLETYPE=0;\"\n    End If\n    'Database name (DATABASE=<path>):\n    strConn = strConn & \"DATABASE=\" _\n        & Application.CurrentDb.Name & \";\"\n    'Profile name (optional):\n    strConn = strConn & \"PROFILE=Windows Messaging Settings;\"\n    'Password (optional):\n    \n    If IsAddressBook Then\n        Set tdfDAO = Application.CurrentDb _\n            .CreateTableDef(\"twmAddressBook\")\n    Else\n        Set tdfDAO = Application.CurrentDb _\n            .CreateTableDef(\"twmWebCom\")\n    End If\n    \n    With tdfDAO\n        .Connect = strConn\n        If IsAddressBook Then\n            .SourceTableName = \"Personal Address Book\"\n        Else\n            .SourceTableName = \"WebCom Accesses\"\n        End If\n    End With\n    \n    With Application.CurrentDb\n        .TableDefs.Append tdfDAO\n        VBA.MsgBox tdfDAO.Name _\n            & \" has been linked to this database.\", vbInformation\n        .TableDefs.Refresh\n    End With\n\n    Application.RefreshDatabaseWindow\n\nbasMessagingLink_Exit:\n    Exit Sub\n    \nbasMessagingLink_Err:\n    Select Case VBA.Err\n        Case 3000\n            VBA.MsgBox \"There is a problem with \" _\n                & \"the connection string.\", vbCritical\n            Resume basMessagingLink_Exit\n        Case 3170\n            VBA.MsgBox \"Windows Messaging Installable ISAM \" _\n                & \"(in Msexch32.dll) not found or not \" _\n                & \"registered.\", vbCritical\n            Resume basMessagingLink_Exit\n        Case 3012\n            VBA.MsgBox tdfDAO.Name _\n                & \" is already linked to this database.\", _\n                vbInformation\n            Resume basMessagingLink_Exit\n        Case Else\n            VBA.MsgBox VBA.Err & \": \" & VBA.Err.Description, _\n                vbCritical, \"basMessagingLink Error\"\n            Resume basMessagingLink_Exit\n    End Select\n\nEnd Sub",
  "Tag": "kb-1374649060"
}