{
  "Document": {
    "DocumentId": 605362455,
    "Title": "Code: a Delay with DoEvents",
    "DocumentShortName": null,
    "FileName": null,
    "Path": null,
    "CreateDate": "1998-11-30T08:59:56",
    "ModificationDate": "1998-11-30T08:59:56",
    "TemplateId": null,
    "SegmentId": 63,
    "IsRoot": false,
    "IsActive": true,
    "SortOrdinal": null,
    "ClientId": null,
    "Tag": null
  },
  "Content": "'Note that Access Basic does not have a Date data type.\n'Dates are stored as double-precision, floating point\n'numbers. For more information please see the following\n'Microsoft Knowledge Base Articles:\n'Q130514: \"ACC: Storing, Calculating, and Comparing\n'Date/Time Data\"\n'Q88657: \"ACC: Functions for Calculating and Displaying\n'Date/Time Values\"\n'\nSub basCountDown (argDate As Variant)\n\n    If IsDate(argDate) Then\n    \n        Do\n\n            If g_intStopWaiting Then\n                Exit Sub\n            End If\n\n            DoEvents\n        Loop Until Now > argDate\n        \n    Else\n\n        MsgBox \"Invalid Date!\", 16, \"basCountDown Error\"\n        g_intStopWaiting = True\n\n    End If\n\nEnd Sub\n'\n'Here is a sample procedure passing an argument\n'to this function:\n'\nFunction basFreshenData (argStr As String) As Integer\n\n    On Error GoTo basFreshenData_Err\n\n    g_intIsRunning = True\n\n    Select Case argStr\n        Case \"Weekday\"\n            g_varReturn = Date + TimeSerial(23, 59, 0)\n\n        Case \"Weekend\"\n            'The last day of current week:\n            g_varReturn = Date - Weekday(Date) + 7\n            g_varReturn = g_varReturn + TimeSerial(23, 59, 0)\n\n    End Select\n\n    basFreshenData = True\n\n    Forms!frmMain.Caption = \"Waiting for \" & g_varReturn & \"...\"\n\n    basCountDown (g_varReturn)\n\n    'etc....\n\n    End Function\n'\n'Notice how a variant is used to store date values\n'in Acces Basic. Also note how no strings are used\n'to handle dates. This procedure should be immune\n'to regional settings.\n'",
  "Tag": "kb605362455"
}