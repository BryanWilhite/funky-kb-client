{
  "Document": {
    "DocumentId": 897085614,
    "Title": "Book: Level 2: Programming Visual Basic 5.0; Chapter 17 Highlights: Data Access Objects And Forms",
    "DocumentShortName": null,
    "FileName": null,
    "Path": null,
    "CreateDate": "1998-10-01T13:40:49",
    "ModificationDate": "1998-10-01T13:40:49",
    "TemplateId": null,
    "SegmentId": 75,
    "IsRoot": false,
    "IsActive": true,
    "SortOrdinal": null,
    "ClientId": null,
    "Tag": null
  },
  "Content": "Opening the Database and Instancing the Recordset\n\nTo open the database and instance the Recordset object behind one unbound form, the following design is recommended:\n\nUse module-level variables of type Recordset and Database.\n\nThe load event of the form should call one or more functions of type boolean that return true when the .MDB file (the database) is opened sucessfully and when a record set is ready. When these conditions are met, a procedure should be called to display the data. The form on page 17-2 shows only one record at a time. This design avoids the complex issues associated with showing several rows of editable data.\n\nThe form should have navigation buttons.\n\nThe form should have \"find,\" \"new record,\" \"delete,\" and \"close\" buttons.\n\nThere should be module-level variables of type Boolean that track when data is being changed or added.\n\n\nDisplaying Data on the Form\n\nPage 17-7 shows the procedure used to display data one record at a time. Note that database records can contain Null values, but VB TextBox controls cannot handle Nulls. The way to avoid this problem is to concatenate a zero-length string to the value of Recordset.Fields(<index>). Since the value Empty is equivalent to a zero-length string we have the form\n\n    With rsDAO\n        If .RecordCount Then\n            txtControl1.Text = .Fields(\"Field1\") & Empty\n            txtControl2.Text = .Fields(\"Field2\") & Empty\n            txtControl3.Text = .Fields(\"Field3\") & Empty\n        End If\n    End With\n\nOr, using the style in the book, we have the form\n\n    With rsDAO\n        If .RecordCount >0 Then\n            txtControl1.Text = !Field1 & Empty\n            txtControl2.Text = !Field2 & Empty\n            txtControl3.Text = !Field3 & Empty\n        End If\n    End With\n\nwhich does not reflect the fact that database fields are part of a collection. To quickly verifiy that this concatenation actually works, type the following in the Immediate (Debug) Window:\n\n    ?Null & Empty = Empty\n\nThis should return True.",
  "Tag": "kb897085614"
}