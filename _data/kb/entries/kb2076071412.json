{
  "Document": {
    "DocumentId": 2076071412,
    "Title": "VB Script and ASP Code: basCriteria(); Building Dynamic HTML Based on Variable Form Input",
    "DocumentShortName": null,
    "FileName": null,
    "Path": null,
    "CreateDate": "2001-09-06T19:52:52.01",
    "ModificationDate": "2001-09-06T19:52:52.01",
    "TemplateId": null,
    "SegmentId": 67,
    "IsRoot": false,
    "IsActive": true,
    "SortOrdinal": null,
    "ClientId": null,
    "Tag": null
  },
  "Content": "Function basCriteria(vSQL,vDBField,vComparison,vFormValue,vDataType)\n    'Based on http://15seconds.com/issue/010629.htm.\n\n    Dim vValue,vArrayVal,vArray,vClauseStyle,vConnector\n    Dim vWildCard,vStrChar\n        \n    'ADO overrides the Microsoft Access MS-SQL wildcard ('*') and text delimiter (\"):\n    vWildCard = \"%\"\n    vStrChar = Chr(39)\n\n    basCriteria = vSQL\n    vValue = vFormValue\n    If Len(vValue) = 0 then Exit Function \n\n    vComparison = Trim(vComparison)\n    vDataType = Trim(vDataType)\n    vClauseStyle = Ucase(vComparison & \":\" & vDataType)\n          \n    Select Case vClauseStyle\n    Case \"=:CHR\"\n        vValue = vStrChar & Replace(vValue,vStrChar,vStrChar & vStrChar) & vStrChar\n              \n    Case \"=:NUM\", \">:NUM\", \"<:NUM\"\n        If (Not IsNumeric(vValue)) Then vValue = 0\n              \n    Case \"IN:CHR\"\n        vValue=Replace(vValue,\", \",\",\")\n        vValue=Replace(vValue,vStrChar,vStrChar & vStrChar)\n        vValue=\"(\" & vStrChar & Replace(vValue,\",\",vStrChar & \",\" & vStrChar) & vStrChar & \")\"\n          \n    Case \"IN:NUM\"\n        vValue=\"\"\n        For Each vArrayVal In vArray\n          If IsNumeric(vArrayVal) Then vValue = vValue & \",\" & Trim(vArrayVal)\n        Next\n\n        If Len(vValue) < 2 Then Exit Function \n        vValue = Mid(vValue,2) 'Remove leading comma.\n        vValue = \"(\" & vValue & \")\"\n                      \n    Case \"*:CHR\" 'Containing:\n        vComparison = \" LIKE \"\n        vValue = vStrChar & vWildCard & Replace(vValue,vStrChar,vStrChar & vStrChar) & vWildCard & vStrChar\n\n    Case \"=*:CHR\" 'Starting with:\n        vComparison = \" LIKE \"\n        vValue = vStrChar & vWildCard & Replace(vValue,vStrChar,vStrChar & vStrChar) & vStrChar\n\n    Case \"*=:CHR\" 'Ending with:\n        vComparison = \" LIKE \"\n        vValue = vStrChar & Replace(vValue,vStrChar,vStrChar & vStrChar) & vWildCard & vStrChar\n\n    Case Else\n        Err.Raise 1,\"Function basCriteria\", _\n            (\"Missing case for '\" & vClauseStyle & \"'\")\n    End Select\n\n    vConnector=\" WHERE \" 'For first criterion only.\n    If 0 < Instr(1,vSQL,\"WHERE\") Then vConnector = \" AND \" \n\n    basCriteria = vSQL & vConnector & vDBField & vComparison & vValue          \nEnd Function\n",
  "Tag": "kb2076071412"
}