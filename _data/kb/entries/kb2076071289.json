{
  "Document": {
    "DocumentId": 2076071289,
    "Title": "JavaScript: Timer Code",
    "DocumentShortName": null,
    "FileName": null,
    "Path": null,
    "CreateDate": "2000-12-21T09:35:19.22",
    "ModificationDate": "2000-12-21T09:35:19.22",
    "TemplateId": null,
    "SegmentId": 67,
    "IsRoot": false,
    "IsActive": true,
    "SortOrdinal": null,
    "ClientId": null,
    "Tag": null
  },
  "Content": "//(c) 1998 Bryan Wilhite\n//All rights reserved.\n//rasx@kintespace.com\n\n//This code assumes that there is a text input object\n//called \"textDisplay\" in a FORM block level element.\n//It is also assumed that there are two buttons.\n//One calls jsTimerStart() and the other\n//calls jsTimerStop() when their\n//onClick() events fire.\n\nvar isRunning = false\nvar timeoutID = null\nvar vLater = null\n\nfunction jsTimer() {\n    vNow = new Date()\n    vNow = vNow.getTime()\n    //Change vDelta into a value in milliseconds.\n    vDelta = vLater - vNow\n    if (vDelta <= 0) { jsTimerStop() }\n    else {\n        //Change vDelta into an object.\n        vDelta = new Date(vDelta)\n        //Change vDelta into an value in seconds.\n        vDelta = vDelta.getSeconds()\n        window.document.forms[1].textDisplay.value =\n            ((vDelta < 10) ? \":0\" : \":\") + vDelta\n        if (isRunning) { timeoutID = setTimeout(\"jsTimer()\", 1000) }\n    }\n}\n\nfunction jsTimerStart(vSeconds) {\n    isRunning = true\n    vNow = new Date()\n    vNow = vNow.getTime()\n    vLater = vNow + (1000 * vSeconds)\n    jsTimer()\n}\n\nfunction jsTimerStop() {\n    if (isRunning) {\n        clearTimeout(timeoutID)\n        window.document.forms[1].textDisplay.value = \":00\"\n        isRunning = false\n    }\n    else { window.alert(\"Timer is already stopped.\") }\n}",
  "Tag": "kb2076071289"
}