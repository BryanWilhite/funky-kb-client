{
  "Document": {
    "DocumentId": 2076072116,
    "Title": "PowerShell 1.0 Script: Toggle-Service; Start-Service, Stop-Service, Write-Host",
    "DocumentShortName": null,
    "FileName": null,
    "Path": null,
    "CreateDate": "2009-03-29T15:18:40",
    "ModificationDate": "2009-03-29T15:18:40",
    "TemplateId": null,
    "SegmentId": 79,
    "IsRoot": false,
    "IsActive": true,
    "SortOrdinal": null,
    "ClientId": null,
    "Tag": null
  },
  "Content": "Function Toggle-Service([String] $name, [String[]] $dependents = @())\n{\n    $s = Get-Service $name;\n\n    if ($s)\n    {\n        Write-Host -BackgroundColor Green -ForegroundColor White \"Service\"$s.Name\"found.\";\n        if ( $s.Status -eq \"Stopped\" )\n        {\n            Write-Host -BackgroundColor Gray -ForegroundColor White -NoNewline \"Service is stopped.\";\n            Write-Host -BackgroundColor Green -ForegroundColor White \" Starting service…\";\n            Start-Service -Name $s.Name;\n            foreach($dname in $dependents)\n            {\n                Write-Host -BackgroundColor Green -ForegroundColor White \"Starting dependent Service\"$dname\"…\";\n                Start-Service -Name $dname;\n            }\n        }\n        else\n        {\n            Write-Host -BackgroundColor Green -ForegroundColor White -NoNewline \"Service\"$s.Name\"is running.\";\n            Write-Host -BackgroundColor Gray -ForegroundColor White \" Stopping service…\";\n            Stop-Service -Name $s.Name -Force;\n        }\n    }\n    else\n    {\n        Write-Host -BackgroundColor Red -ForegroundColor White \"Service not found.\";\n    }\n}\n",
  "Tag": "kb2076072116"
}