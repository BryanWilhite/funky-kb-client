{
  "Document": {
    "DocumentId": 2076071955,
    "Title": "XPathDocument.XPathNavigator Throws NotSupportedException for AppendChild() and AppendchildElement() Methods",
    "DocumentShortName": null,
    "FileName": null,
    "Path": null,
    "CreateDate": "2008-05-02T09:45:15",
    "ModificationDate": "2008-05-02T09:45:15",
    "TemplateId": null,
    "SegmentId": 83,
    "IsRoot": false,
    "IsActive": true,
    "SortOrdinal": null,
    "ClientId": null,
    "Tag": null
  },
  "Content": "XPathDocument.XPathNavigator throws NotSupportedException for AppendChild() and AppendchildElement() methods. Generating XPathNavigator from XmlDocument behaves as expected:\n\n    string contoso = @\"\n<bookstore>\n<book genre=\"\"autobiography\"\" publicationdate=\"\"1981-03-22\"\" ISBN=\"\"1-861003-11-0\"\">\n    <title>The Autobiography of Benjamin Franklin</title>\n    <author>\n        <first-name>Benjamin</first-name>\n        <last-name>Franklin</last-name>\n    </author>\n    <price>8.99</price>\n</book>\n<book genre=\"\"novel\"\" publicationdate=\"\"1967-11-17\"\" ISBN=\"\"0-201-63361-2\"\">\n    <title>The Confidence Man</title>\n    <author>\n        <first-name>Herman</first-name>\n        <last-name>Melville</last-name>\n    </author>\n    <price>11.99</price>\n</book>\n<book genre=\"\"philosophy\"\" publicationdate=\"\"1991-02-15\"\" ISBN=\"\"1-861001-57-6\"\">\n    <title>The Gorgias</title>\n    <author>\n        <name>Plato</name>\n    </author>\n    <price>9.99</price>\n</book>\n</bookstore>\n\" ;\n    XmlDocument document = new XmlDocument();\n    document.LoadXml( contoso );\n    XPathNavigator navigator = document.CreateNavigator();\n\n    navigator.MoveToChild( \"bookstore\", \"\" );\n    navigator.MoveToChild( \"book\", \"\" );\n\n    navigator.AppendChildElement( \"\", \"pages\", \"\", \"100\" );\n\n    Console.WriteLine( navigator.OuterXml );\n\nHowever, the following (with XPathDocument) does not work:\n\n    XPathDocument document =\n        new XPathDocument( new StringReader( contoso ) );\n    XPathNavigator navigator = document.CreateNavigator();\n\n    navigator.MoveToChild( \"bookstore\", \"\" );\n    navigator.MoveToChild( \"book\", \"\" );\n\n    navigator.AppendChildElement( \"\", \"pages\", \"\", \"100\" );\n    //NotSupportedException thrown here! \n\n    Console.WriteLine( navigator.OuterXml );\n\nTo be generous, one can argue that this behavior is “by design” because the XPathdocument is designed to be read only.\n\nThe examples here are derived from the Microsoft documentation:\n\n    http://msdn.microsoft.com/en-us/library/\n        system.xml.xpath.xpathnavigator.appendchildelement.aspx\n\n",
  "Tag": "kb2076071955"
}