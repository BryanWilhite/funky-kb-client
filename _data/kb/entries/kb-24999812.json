{
  "Document": {
    "DocumentId": -24999812,
    "Title": "Code: dbAvailable() -- Checking for Exclusivity",
    "DocumentShortName": null,
    "FileName": null,
    "Path": null,
    "CreateDate": "2000-08-14T20:52:00",
    "ModificationDate": "2000-08-14T20:52:00",
    "TemplateId": null,
    "SegmentId": 63,
    "IsRoot": false,
    "IsActive": true,
    "SortOrdinal": null,
    "ClientId": null,
    "Tag": null
  },
  "Content": "Function dbAvailable (strDatabase As String) As Integer\n'\n'This function checks to see if a database can\n'be opened exclusively.\n'\n'NOTE: This procedure contains line break characters\n'for readability. These characters are not supported\n'in Access Basic.\n'\n    Dim DAO_WorkSpace As WorkSpace\n    Dim DAO_Database As Database\n    \n    On Error GoTo dbAvailable_Err\n\n    Set DAO_WorkSpace = DBEngine.Workspaces(0)\n    Set DAO_Database = _\n        DAO_WorkSpace.OpenDatabase(strDatabase, True, True)\n    '\n    'Return -1 on no errors.\n    '\n    dbAvailable = True\n\ndbAvailable_Exit:\n    '\n    'If an object variable is Nothing it\n    'has not been Set or initialized.\n    '\n    If Not (DAO_WorkSpace Is Nothing) Then DAO_WorkSpace.Close\n\n    If Not (DAO_Database Is Nothing) Then DAO_Database.Close\n\n    Exit Function\n\ndbAvailable_Err:\n    '\n    'On error let the function return the error code.\n    'Recall that Err returns Integers.\n    '\n    dbAvailable = Err\n    GoTo dbAvailable_Exit\n\nEnd Function",
  "Tag": "kb-24999812"
}