{
  "Document": {
    "DocumentId": 2076071816,
    "Title": "Windows Server 2003: Installing OpenSSH",
    "DocumentShortName": null,
    "FileName": null,
    "Path": null,
    "CreateDate": "2007-04-17T21:12:14",
    "ModificationDate": "2007-04-17T21:12:14",
    "TemplateId": null,
    "SegmentId": 79,
    "IsRoot": false,
    "IsActive": true,
    "SortOrdinal": null,
    "ClientId": null,
    "Tag": null
  },
  "Content": "These notes are a \"remixed\" version of \"OpenSSH for Windows 2003 Server\" by Stephen Pillinger of the University of Birmingham here:\n\n    http://www.cs.bham.ac.uk/%7Esmp/projects/ssh-windows/\n\nYou should look at this reference for issues related to host-based authentication and public key authentication.\n\nThere are two known ways to install a free ssh server on Windows Server 2003. The first way is to install the full Cygwin distribution with a package manager. This process in described by Kevin Scully of University of Waterloo here:\n\n    http://ist.uwaterloo.ca/%7Ekscully/CygwinSSHD_W2K3.html\n\nThe other method is installing OpenSSH that uses a subset of Cygwin. This process described by Stephen Pillinger (see above) requires Windows Server 2003 Resource Kit Tools, now available here:\n\n    http://www.microsoft.com/downloads/\n        details.aspx?FamilyID=\n            9d467a69-57ff-4ae7-96ee-b18c4790cffd&DisplayLang=en\n\nOpen SSH is available here:\n\n    http://sshwindows.sourceforge.net/\n\nThe default installation directory is this:\n\n    %ProgramFiles%\\OpenSSH\\\n\nEdit this file:\n\n    %ProgramFiles%\\OpenSSH\\etc\\sshd_config\n\nto make this line:\n\n    UsePrivilegeSeparation yes\n\nNow to the command line:\n\n    mkdir %ProgramFiles%\\OpenSSH\\var\\empty\\\n\nNote that the \\var\\empty\\ is a path that is required by default.\n\n    net user sshd yourPassword\n        /add /fullname:\"User for OpenSSH Service\"\n        /homedir:\"%ProgramFiles%\\OpenSSH\\var\\empty\\\"\n\n    sc config OpenSSHd obj= .\\sshd password= yourPassword\n\nNote that you cannot use the %ProgramFiles% syntax used above for the /homedir option.\n\n    net localgroup Administrators sshd /add\n\n    ntrights +r SeAssignPrimaryTokenPrivilege -u sshd\n    ntrights +r SeCreateTokenPrivilege -u sshd\n    ntrights +r SeDenyInteractiveLogonRight -u sshd\n    ntrights +r SeDenyNetworkLogonRight -u sshd\n    ntrights +r SeDenyRemoteInteractiveLogonRight -u sshd\n    ntrights +r SeIncreaseQuotaPrivilege -u sshd\n    ntrights +r SeServiceLogonRight -u sshd\n\nNote that ntrights.exe is part of the Windows Server 2003 Resource Kit Tools.\n\n    cacls \"%ProgramFiles%\\OpenSSH\" /E /T /G sshd:R\n    cacls \"%ProgramFiles%\\OpenSSH\\var\" /E /T /G sshd:F\n\n    subinacl /subdirectories \"%ProgramFiles%\\OpenSSH\\var\\*.*\" /setowner=\"sshd\" \n\nNote that in order for the above SUBINACL.EXE command to work you have to install an update from Microsoft here:\n\n    http://www.microsoft.com/downloads/\n        details.aspx?FamilyID\n            =e8ba3e56-d8fe-4a91-93cf-ed6985e3927b&displaylang=en\n\n    cd %ProgramFiles%\\OpenSSH\\bin\\\n    mkgroup -l > ..\\etc\\group\n    mkpasswd -l > ..\\etc\\passwd\n\nNote that you should delete any unnecessary groups and users from %ProgramFiles%\\OpenSSH\\etc\\group and %ProgramFiles%\\OpenSSH\\etc\\passwd respectively.\n\nAlso you might want to comment out the Banner message under \"# default banner path\" in %ProgramFiles%\\OpenSSH\\etc\\sshd_config.",
  "Tag": "kb2076071816"
}