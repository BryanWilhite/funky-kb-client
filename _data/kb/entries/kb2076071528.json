{
  "Document": {
    "DocumentId": 2076071528,
    "Title": "T-SQL Code: Correlated Sub-Queries in the SELECT Projection List",
    "DocumentShortName": null,
    "FileName": null,
    "Path": null,
    "CreateDate": "2003-08-11T16:44:17",
    "ModificationDate": "2003-08-11T16:44:17",
    "TemplateId": null,
    "SegmentId": 72,
    "IsRoot": false,
    "IsActive": true,
    "SortOrdinal": null,
    "ClientId": null,
    "Tag": null
  },
  "Content": "Microsoft readily reminds us that \"correlated subqueries\" can be included in the WHERE clause:\n\n    SELECT au_lname, au_fname\n    FROM authors\n    WHERE 100 IN\n       (SELECT royaltyper\n       FROM titleauthor\n       WHERE titleauthor.au_ID = authors.au_id)\n\nThis form is discussed in detail here:\n\n    http://msdn.microsoft.com/library/en-us/acdata/ac_8_qd_11_67lc.asp\n\nBut what is not mentioned is that these sub-queries are supported in the SELECT projection list like the following:\n\n    SELECT DISTINCT\n        title_id\n    ,   au1 = (\n            SELECT\n                au_id\n            FROM\n                titleauthor\n            WHERE\n                au_ord = 1\n            AND\n                title_id = t.title_id\n        )\n    FROM\n        titleauthor AS t\n\nIt is an error to use a sub-query that returns more than one row of data. This form is discussed in detaail in \"The Practical SQL Handbook\" (a link to the book should be listed on this page at songhaysystem.com).",
  "Tag": "kb2076071528"
}