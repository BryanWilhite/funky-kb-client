{
  "Document": {
    "DocumentId": 715694788,
    "Title": "VB: ADO; Code; Reading and Writing Strings to a DAO Table",
    "DocumentShortName": null,
    "FileName": null,
    "Path": null,
    "CreateDate": "1999-03-01T13:35:47",
    "ModificationDate": "1999-03-01T13:35:47",
    "TemplateId": null,
    "SegmentId": 77,
    "IsRoot": false,
    "IsActive": true,
    "SortOrdinal": null,
    "ClientId": null,
    "Tag": null
  },
  "Content": "Public Function basGetString(KeyName As String, ColumnName As String) As String\n    \n    On Error GoTo basGetString_Err\n    \n    Set m_rsADO = New ADODB.Recordset\n    m_rsADO.Open Source:=\"tblStrings\", _\n        ActiveConnection:=m_cnnADO, _\n        CursorType:=adOpenKeyset, _\n        LockType:=adLockReadOnly, _\n        Options:=adCmdTable\n\n    With m_rsADO\n        .Find Criteria:=\"name = '\" & KeyName & \"'\", _\n            SearchDirection:=adSearchForward\n        If Not .EOF Then _\n            basGetString = .Fields(ColumnName) & Empty\n    End With\n    \nbasGetString_Exit:\n    m_rsADO.Close\n    Set m_rsADO = Nothing\n    Exit Function\n    \nbasGetString_Err:\n    Select Case Err\n        Case Else\n            MsgBox Err & \": \" & Err.Description, vbCritical, \"basGetString Error\"\n            Resume basGetString_Exit\n    End Select\n    \nEnd Function\n\nPublic Sub basWriteString(KeyName As String, NewStr As String)\n    \n    Dim strSQL As String\n    \n    On Error GoTo basWriteString_Err\n    \n    strSQL = \"UPDATE tblStrings SET tblStrings.string = \"\"\" & NewStr & \"\"\"\" _\n        & \" WHERE tblStrings.name = \"\"\" & KeyName & \"\"\"\"\n    \n    Set m_cmdADO = New ADODB.Command\n    \n    With m_cmdADO\n        .ActiveConnection = m_cnnADO\n        .CommandType = adCmdText\n        .CommandText = strSQL\n        .Execute\n    End With\n    \nbasWriteString_Exit:\n    Set m_cmdADO = Nothing\n    Exit Sub\n    \nbasWriteString_Err:\n    Select Case Err\n        Case Else\n            MsgBox Err & \": \" & Err.Description, vbCritical, \"basWriteString Error\"\n            Resume basWriteString_Exit\n    End Select\n    \nEnd Sub",
  "Tag": "kb715694788"
}