{
  "Document": {
    "DocumentId": 566367175,
    "Title": "VB: ADO; Using the Properties Collection of the Connection Object",
    "DocumentShortName": null,
    "FileName": null,
    "Path": null,
    "CreateDate": "2000-02-09T22:51:03",
    "ModificationDate": "2000-02-09T22:51:03",
    "TemplateId": null,
    "SegmentId": 77,
    "IsRoot": false,
    "IsActive": true,
    "SortOrdinal": null,
    "ClientId": null,
    "Tag": null
  },
  "Content": "I use the Properties Collection of the Connection object to enter custom log information during a database connection. For example the sub LogSession is called (repeatedly) during the ConnectComplete Event:\n\nPrivate Sub pADOcnn_ConnectComplete(ByVal pError As ADODB.Error, _\n        adStatus As ADODB.EventStatusEnum, _\n        ByVal pConnection As ADODB.Connection)\n    \n        If adStatus = adStatusOK Then\n            Call LogSession(\"Data Connection established (\" _\n                & VBA.Now & \")\")\n            Call LogSession(VBA.Space$(4) _\n                & \"User ID:                      \" _\n                & pConnection.Properties.Item(\"User ID\"))\n            If pConnection.Provider Like \"SQLOLEDB*\" Then _\n            Call LogSession(VBA.Space$(4) _\n                & \"Workstation ID:               \" _\n                & pConnection.Properties.Item(\"Workstation ID\"))\n            Call LogSession(VBA.Space$(4) _\n                & \"Data Source DBMS Name:        \" _\n                & pConnection.Properties.Item(\"DBMS Name\"))\n            Call LogSession(VBA.Space$(4) _\n                & \"Data Source DBMS Version:     \" _\n                & pConnection.Properties.Item(\"DBMS Version\"))\n            Call LogSession(VBA.Space$(4) _\n                & \"Data Source Current Catalog:  \" _\n                & pConnection.Properties.Item(\"Current Catalog\"))\n            Call LogSession(VBA.Space$(4) _\n                & \"Data Source Provider Name:    \" _\n                & pConnection.Properties.Item(\"Provider Name\"))\n            Call LogSession(VBA.Space$(4) _\n                & \"Data Source Provider Version: \" _\n                & pConnection.Properties.Item(\"DBMS Version\"))\n        ElseIf adStatus = adStatusErrorsOccurred Then\n            Call EnvironmentErr(pError)\n            Call LogSession(\"ERROR (\" & VBA.Now & \"):\" _\n                & p_strErrMsg)\n        End If\n    End Sub\n\nThe Key strings for the Properties Collection is based on MS KB article Q193135 (\"INFO: Initialization Properties for SQLOLEDB OLE DB Provider\").",
  "Tag": "kb566367175"
}