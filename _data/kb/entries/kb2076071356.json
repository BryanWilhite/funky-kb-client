{
  "Document": {
    "DocumentId": 2076071356,
    "Title": "Microsoft JScript: Generic Functions for RDS Data Binding; Data Source Objects; DSO",
    "DocumentShortName": null,
    "FileName": null,
    "Path": null,
    "CreateDate": "2000-12-31T00:33:19.573",
    "ModificationDate": "2000-12-31T00:33:19.573",
    "TemplateId": null,
    "SegmentId": 67,
    "IsRoot": false,
    "IsActive": true,
    "SortOrdinal": null,
    "ClientId": null,
    "Tag": null
  },
  "Content": "The function listed below, jsBindData(), depends on HTML similar to the following:\n\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\">\n<HTML>\n<HEAD>\n    <LINK REL=stylesheet TYPE=\"text/css\" HREF=\"./root.css\">\n    <META NAME=Generator CONTENT=\"Bryan Wilhite\">\n    <META NAME=Reply-To CONTENT=\"rasx@kintespace.com\">\n    <META NAME=Keywords CONTENT=\"Songhay System, email, kinte space\">\n    <META NAME=Description CONTENT=\"Email List\">\n    <SCRIPT LANGUAGE=\"JavaScript\" TYPE=\"text/javascript\" SRC=\"./root.js\"></SCRIPT>\n    <SCRIPT LANGUAGE=\"JavaScript\" TYPE=\"text/javascript\" SRC=\"./email.js\"></SCRIPT>\n    <TITLE>Songhay System: Email List</TITLE>\n</HEAD>\n<BODY BACKGROUND=\"http://Songhay3/kRoot/bitmaps/backgrnd.gif\" BGCOLOR=Black TEXT=White LINK=Lime VLINK=Silver ALINK=Yellow onLoad=\"jsFormat()\">\n<!-- RDS.DataControl Objects: -->\n<OBJECT CLASSID=\"clsid:BD96C556-65A3-11D0-983A-00C04FC29E33\" ID=dsoEmail HEIGHT=0 WIDTH=0>\n    <PARAM NAME=Connect VALUE=\"Provider=SQLOLEDB.1;Persist Security Info=False;User ID=sa;Initial Catalog=kinteDB;Data Source=SONGHAY3\">\n    <PARAM NAME=Server VALUE=\"http://Songhay3\">\n    <PARAM NAME=SQL VALUE=\"EXECUTE ListDSOEmail\">\n</OBJECT>\n<OBJECT CLASSID=\"clsid:BD96C556-65A3-11D0-983A-00C04FC29E33\" ID=dsoEmailTypes HEIGHT=0 WIDTH=0>\n    <PARAM NAME=Connect VALUE=\"Provider=SQLOLEDB.1;Persist Security Info=False;User ID=sa;Initial Catalog=kinteDB;Data Source=SONGHAY3\">\n    <PARAM NAME=Server VALUE=\"http://Songhay3\">\n    <PARAM NAME=SQL VALUE=\"EXECUTE ListDSOEmail 1\">\n</OBJECT>\n<OBJECT CLASSID=\"clsid:BD96C556-65A3-11D0-983A-00C04FC29E33\" ID=dsoEmailFilter HEIGHT=0 WIDTH=0>\n    <PARAM NAME=Connect VALUE=\"Provider=SQLOLEDB.1;Persist Security Info=False;User ID=sa;Initial Catalog=kinteDB;Data Source=SONGHAY3\">\n    <PARAM NAME=Server VALUE=\"http://Songhay3\">\n    <PARAM NAME=SQL VALUE=\"EXECUTE ListDSOEmail 2\">\n</OBJECT>\n<TABLE WIDTH=512 BORDER=0 CELLSPACING=0 CELLPADDING=4 ALIGN=center>\n    <TR>\n        <TH ALIGN=left NOWRAP>\n            email type:\n        </TH>\n        <TD COLSPAN=2>\n            <SELECT CLASS=frmInput ID=lstEmailType NAME=\"#dsoEmail_emailTypeID\" SIZE=1>\n            </SELECT>\n        </TD>\n    </TR>\n    <TR>\n        <TH ALIGN=left NOWRAP>\n            email address:\n        </TH>\n        <TD COLSPAN=2>\n            <INPUT CLASS=frmInput ID=txtEmailAddress NAME=\"#dsoEmail_emailAddress\" TYPE=text MAXLENGTH=255 SIZE=32 onBlur=\"jsIsEmailValid(this)\">\n        </TD>\n    </TR>\n    <TR>\n        <TH ALIGN=left>\n            url:\n        </TH>\n        <TD COLSPAN=2>\n            <INPUT CLASS=frmInput ID=txtURL NAME=\"#dsoEmail_url\" TYPE=text MAXLENGTH=512 SIZE=48>\n        </TD>\n    </TR>\n    <TR>\n        <TH ALIGN=left>\n            first:\n        </TH>\n        <TD>\n            <INPUT CLASS=frmInput ID=txtFirst NAME=\"#dsoEmail_first\" TYPE=text MAXLENGTH=32 SIZE=32>\n        </TD>\n        <TD ALIGN=right ROWSPAN=2 NOWRAP VALIGN=middle>\n<STRONG>tagged?:</STRONG>\n            <INPUT ID=chkTagged NAME=\"#dsoEmail_tagged\" TYPE=checkbox>\n<BR>\n<STRONG>send?:</STRONG>\n            <INPUT ID=chkSend NAME=\"#dsoEmail_send\" TYPE=checkbox>\n        </TD>\n    </TR>\n    <TR>\n        <TH ALIGN=left>\n            last:\n        </TH>\n        <TD>\n            <INPUT CLASS=frmInput ID=txtLast NAME=\"#dsoEmail_last\" TYPE=text MAXLENGTH=32 SIZE=32>\n        </TD>\n    </TR>\n    <TR>\n        <TD COLSPAN=3>\n<STRONG>note:</STRONG>\n<BR>\n            <TEXTAREA CLASS=frmInput ID=txtNote NAME=\"#dsoEmail_note\" ROWS=7 COLS=54></TEXTAREA>\n        </TD>\n    </TR>\n    <TR>\n        <!-- Record filtering: -->\n        <TD COLSPAN=3>\n        <TABLE BORDER=0 CELLPADDING=0 CELLSPACING=0 WIDTH=\"100%\">\n            <TR>\n                <TD VALIGN=middle>\n                    <SELECT CLASS=frmCtrl ID=lstFilter NAME=lstFilter SIZE=1 onChange=\"jsFilter('onchange',dsoEmail)\">\n                        <OPTION VALUE=\"#default\" SELECTED>filtering commands</OPTION>\n                    </SELECT>                     \n                    <INPUT CLASS=frmCtrl ID=txtFilter NAME=txtFilter TYPE=text MAXLENGTH=32 SIZE=16> \n                    <INPUT CLASS=frmCtrl ID=cmdFilter NAME=cmdFilter TYPE=button VALUE=\"filter on\" TITLE=\"Filter Records\" onClick=\"jsFilter('onclick',dsoEmail)\">\n                </TD>\n                <TD ALIGN=right>\n                    <!-- Record navigation: -->\n                    <INPUT CLASS=frmCtrl ID=cmdNavFirst NAME=cmdNavFirst TYPE=button VALUE=\"<<\" TITLE=\"Move to the First Record\" onClick=\"jsDSONav(this.name,dsoEmail)\">\n                    <INPUT CLASS=frmCtrl ID=cmdNavPrev NAME=cmdNavPrev TYPE=button VALUE=\"<  \" TITLE=\"Move to the Previous Record\" onClick=\"jsDSONav(this.name,dsoEmail)\">\n                    <INPUT CLASS=frmCtrl ID=cmdNavNext NAME=cmdNavNext TYPE=BUTTON VALUE=\" > \" TITLE=\"Move to the Next Record\" onClick=\"jsDSONav(this.name,dsoEmail)\">\n                    <INPUT CLASS=frmCtrl ID=cmdNavLast NAME=cmdNavLast TYPE=BUTTON VALUE=\">>\" TITLE=\"Move to the Last Record\" onClick=\"jsDSONav(this.name,dsoEmail)\">\n                </TD>\n            </TR>\n        </TABLE>\n        </TD>\n    </TR>\n    <TR>\n        <TD COLSPAN=3>\n            <!-- Record commands: -->\n             \n<BR>\n            <INPUT CLASS=frmCtrl ID=cmdAdd NAME=cmdAdd TYPE=button VALUE=\"add record\" TITLE=\"Add a New Record\" onClick=\"jsDSOAdd(dsoEmail)\">  \n            <INPUT CLASS=cmdDelete ID=cmdDelete NAME=cmdDelete TYPE=button VALUE=\"delete record\" TITLE=\"Delete the Current Record\" onClick=\"jsDSODelete(dsoEmail)\">  \n            <INPUT CLASS=frmCtrl ID=cmdSave NAME=cmdSave TYPE=button VALUE=\"save changes\" TITLE=\"Save Changes to Records\" onClick=\"jsDSOSave(dsoEmail)\">\n            <INPUT ID=chkRefresh NAME=chkRefresh TYPE=checkbox TITLE=\"Check to Save Changes to Records on Server?\"><STRONG>refresh?</STRONG>\n        </TD>\n    </TR>\n    <TR>\n        <TD COLSPAN=3>\n            <!-- Status reports: -->\n        <TABLE BORDER=1 CELLPADDING=0 CELLSPACING=0 WIDTH=\"100%\">\n            <TR>\n                <TD CLASS=frmMsg ID=tdMsg>\n                </TD>\n            </TR>\n        </TABLE>\n        </TD>\n    </TR>\n</TABLE>\n</BODY>\n</HTML>\n\nNow the JScript code:\n\n//ADO variables:\nvar vBookMark = null\n\n//---- EditModeEnum Values ----\nvar adEditNone = 0x0000\nvar adEditInProgress = 0x0001\nvar adEditAdd = 0x0002\nvar adEditDelete = 0x0004\n\n//---- FilterGroupEnum Values ----\nvar adFilterNone = 0\nvar adFilterPendingRecords = 1\nvar adFilterAffectedRecords = 2\nvar adFilterFetchedRecords = 3\nvar adFilterPredicate = 4\nvar adFilterConflictingRecords = 5\n\n//RDS variables:\n//----  RDS.ADCReadyStateEnum Values ----\nvar adcReadyStateLoaded = 2\nvar adcReadyStateInteractive = 3\nvar adcReadyStateComplete = 4\n\nfunction jsBindData() {\n    //This function tries very hard to be generic in the Microsoft sense of the word.\n    //It depends on element ID and NAME properties to be different,\n    //where NAME is of the form <data source>_<data field>.\n\n    var vCollection = document.all.tags(\"INPUT\")\n    if (vCollection != null) {\n        for (var i = 0; i < vCollection.length; i++)  {\n            with(vCollection[i]) {\n                var vStr = name\n                if (vStr.indexOf(\"_\") != -1) {\n\n                    var vArray = vStr.split(\"_\")\n                    \n                    if((type == \"text\") && (readOnly != true)) style.background = \"#C0C0C0 none no-repeat scroll 0% 0%\"\n                    if((type != \"button\") \n                        && (type != \"file\")\n                        && (type != \"image\")\n                        && (type != \"reset\")\n                        && (type != \"submit\")) {\n                        dataSrc = vArray[0]\n                        dataFld = vArray[1]\n                    }\n                }\n            }\n        }\n    }\n\n    vCollection = document.all.tags(\"SELECT\")\n    if (vCollection != null) {\n        for (i = 0; i < vCollection.length; i++)  {\n            with(vCollection[i]) {\n                vStr = name\n                if (vStr.indexOf(\"_\") != -1) {\n\n                    vArray = vStr.split(\"_\")\n\n                    style.background = \"#C0C0C0 none no-repeat scroll 0% 0%\"\n\n                    dataSrc = vArray[0]\n                    dataFld = vArray[1]\n                }\n            }\n        }\n    }\n\n    vCollection = document.all.tags(\"TEXTAREA\")\n    if (vCollection != null) {\n        for (i = 0; i < vCollection.length; i++)  {\n            with(vCollection[i]) {\n                vStr = name\n                if (vStr.indexOf(\"_\") != -1) {\n\n                    vArray = vStr.split(\"_\")\n                    \n                    if(readOnly != true) style.background = \"#C0C0C0 none no-repeat scroll 0% 0%\"\n\n                    dataSrc = vArray[0]\n                    dataFld = vArray[1]\n                }\n            }\n        }\n    }\n}\n\nfunction jsBindSELECT(vDSOrs,vSELECT){\n    with(vDSOrs){\n        while(EOF != true){\n            vOPTION = document.createElement(\"OPTION\")\n            vOPTION.value = vDSOrs.fields(0)\n            vOPTION.text = vDSOrs.fields(1)\n            vSELECT.add(vOPTION)\n            MoveNext()\n        }\n        MoveFirst()\n    }\n}\n\nfunction jsDSOAdd(vDSO) {\n    vDSO.recordset.AddNew()\n}\n\nfunction jsDSODelete(vDSO) {\n    if(window.confirm(\"Are you sure you want to delete this record?\") == false) return\n    if (vDSO.recordset.recordCount > 0) vDSO.recordset.Delete()\n}\n\nfunction jsDSONav(vCmd,vDSO) {\n\n    if(vDSO.recordset.recordcount == 0) {\n        window.alert(\"There are no records to display.\")\n        return\n    }\n    \n    switch(vCmd){\n        case \"cmdNavFirst\":\n            vDSO.recordset.MoveFirst()\n            top.status = window.defaultStatus\n            break\n        case \"cmdNavPrev\":\n            vDSO.recordset.MovePrevious()\n            top.status = window.defaultStatus\n            if (vDSO.recordset.BOF) {\n                vDSO.recordset.MoveFirst()\n                top.status = \"At beginning of records.\"\n            }\n            break\n        case \"cmdNavNext\":\n            vDSO.recordset.MoveNext()\n            top.status = window.defaultStatus\n            if (vDSO.recordset.EOF) {\n                vDSO.recordset.MoveLast()\n                top.status = \"At end of records.\"\n            }\n            break\n        case \"cmdNavLast\":\n            vDSO.recordset.MoveLast()\n            top.status = window.defaultStatus\n            break\n    }\n}\n\nfunction jsDSOSave(vDSO) {\n    with(vDSO) {\n        vBookMark = vDSO.recordset.bookmark\n        SubmitChanges()\n        if(chkRefresh.checked) Refresh()\n    }\n    \n}",
  "Tag": "kb2076071356"
}