{
  "Document": {
    "DocumentId": 2076071385,
    "Title": "T-SQL Code: DELETEing Duplicates",
    "DocumentShortName": null,
    "FileName": null,
    "Path": null,
    "CreateDate": "2001-04-07T18:40:52.38",
    "ModificationDate": "2001-04-07T18:40:52.38",
    "TemplateId": null,
    "SegmentId": 72,
    "IsRoot": false,
    "IsActive": true,
    "SortOrdinal": null,
    "ClientId": null,
    "Tag": null
  },
  "Content": "-- This code is inspired by MS KB article Q139444\n-- (\"INF: How to Remove Duplicate Rows From a Table\").\n\nSELECT\n    [date],host,[file],kbID\nINTO\n    #uVals\nFROM\n    tblKLog\nGROUP BY\n    [date],host,[file],kbID\nHAVING\n    COUNT(*) > 1\n\nDELETE\n    tblKLog\nFROM\n    tblKLog\n,   #uVals\nWHERE\n    tblKLog.[date] = #uVals.[date]\nAND\n    tblKLog.host = #uVals.host\nAND\n    tblKLog.[file] = #uVals.[file]\n\nINSERT INTO\n    tblKLog\nSELECT\n    [date],host,[file],kbID\nFROM\n    #uVals\n\nDROP TABLE #uVals\n\nSELECT\n    [date],host,[file],kbID\nFROM\n    tblKLog\nGROUP BY\n    [date],host,[file],kbID\nHAVING\n    COUNT(*) > 1\n",
  "Tag": "kb2076071385"
}