{
  "Document": {
    "DocumentId": 2076072109,
    "Title": "PowerShell 1 Script: Add Local Users; ADSI; Active Directory; Add-LocalUser",
    "DocumentShortName": null,
    "FileName": null,
    "Path": null,
    "CreateDate": "2009-03-18T20:39:25",
    "ModificationDate": "2009-03-18T20:39:25",
    "TemplateId": null,
    "SegmentId": 79,
    "IsRoot": false,
    "IsActive": true,
    "SortOrdinal": null,
    "ClientId": null,
    "Tag": null
  },
  "Content": "Clear-Host;\n\nFunction Add-LocalUser([String]$userName, [String]$userDescription, [String]$password)\n{\n\t$path = [String]::Concat(\"WinNT://./\",$userName,\",user\");\n\t$user = [ADSI]$path;\n\tif([String]::IsNullOrEmpty($user.Name))\n\t{\n\t\t$computer = [ADSI]\"WinNT://.\";\n\t\t$user = $computer.Create(\"user\", $userName);\n\t\t$user.SetPassword($password);\n\t\t$user.SetInfo();\n\t\t$user.Description = $userDescription;\n\t\t$user.SetInfo();\n\t\t$user.UserFlags += 65536\n                #flag ADS_UF_DONT_EXPIRE_PASSWD = &h10000\n\n\t\t$user.SetInfo();\n\n\t\tWrite-Host \"User\"$user.Name\"added.\";\n\t}\n\telse\n\t{\n\t\tWrite-Host \"User\"$user.Name\"already a Local User.\";\n\t}\n}\n\nAdd-LocalUser \"MyUser\" \"Local Account\" \"my1passw0rd\";\n",
  "Tag": "kb2076072109"
}