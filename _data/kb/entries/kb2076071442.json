{
  "Document": {
    "DocumentId": 2076071442,
    "Title": "PHP Code: File Upload with a Single PHP Script File",
    "DocumentShortName": null,
    "FileName": null,
    "Path": null,
    "CreateDate": "2002-01-15T23:17:52.743",
    "ModificationDate": "2002-01-15T23:17:52.743",
    "TemplateId": null,
    "SegmentId": 67,
    "IsRoot": false,
    "IsActive": true,
    "SortOrdinal": null,
    "ClientId": null,
    "Tag": null
  },
  "Content": "<?php\n    /*\n        This code is loosely based\n        on john@php-dude.com,\n        the post 27-Jul-2001 12:00\n        at http://www.php.net/manual/en/features.file-upload.php.\n    */\n\n    $HTML = NULL;\n\n    if(count($HTTP_POST_FILES) > 0){\n        $allowed_types = array(\"application/pdf\",\"text/plain\",\"text/html\"); \n        $size_limit = \"100000\"; //bytes\n\n        $file = $HTTP_POST_FILES[\"file\"][\"name\"]; \n        $type = $HTTP_POST_FILES[\"file\"][\"type\"]; \n        $size = $HTTP_POST_FILES[\"file\"][\"size\"]; \n        $temp = $HTTP_POST_FILES[\"file\"][\"tmp_name\"]; \n\n        $path_info = pathinfo($PATH_TRANSLATED);\n\n        //Web server anonymous user must have\n        //write permissions to this path:\n        $write_path = $path_info[\"dirname\"] . \"/\" . $file;\n\n        if ($file){ \n            if ($size < $size_limit){ \n                if (in_array($type,$allowed_types)){ \n                    if(move_uploaded_file($temp,$write_path)){\n                        $HTML = \"<div>The file <tt>$file</tt> was sucessfully uploaded.</div>\";\n                    }\n                    else{\n                        $HTML = \"<div>The file <tt>$file</tt> upload failed.</div>\";\n                    }\n                }\n                else { \n                    $HTML = \"<div>Files of type <tt>$type</tt> are not permitted.</div>\"; \n                }\n            }\n            else { \n                $HTML = \"<div>File exceeds the size limit of $size_limit bytes.</div>\";\n            }\n        } \n\n        $HTML .= \"\\n\";\n    }\n?>\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\"\n\"http://www.w3.org/TR/REC-html40/loose.dtd\">\n<html>\n<head>\n    <meta name=VS_TARGETSCHEMA content=\"HTML 4.0\">\n    <meta name=\"editor\" content=\"Bryan Wilhite\">\n    <meta name=\"reply-to\" content=\"bwilhite@ucla.mednet.edu\">\n    <meta name=\"keywords\" content=\"\">\n    <meta name=\"description\" content=\"\">\n    <title>PHP File Upload Test</title>\n</head>\n<body>\n<?php echo $HTML ?>\n<form enctype=\"multipart/form-data\" action=\"<?php echo $PHP_SELF ?>\"\nmethod=\"POST\">\n    Upload a File:\n    <input name=\"file\" type=\"file\">\n    <input type=\"submit\" value=\"Upload\">\n</form>\n</body>\n</html>",
  "Tag": "kb2076071442"
}