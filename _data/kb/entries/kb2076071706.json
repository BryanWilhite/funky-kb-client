{
  "Document": {
    "DocumentId": 2076071706,
    "Title": "DTS ActiveX Script Task: Assigning SQL Statements to Execute SQL Tasks Based on Global Variables",
    "DocumentShortName": null,
    "FileName": null,
    "Path": null,
    "CreateDate": "2005-09-15T15:22:30.583",
    "ModificationDate": "2005-09-15T15:22:30.583",
    "TemplateId": null,
    "SegmentId": 72,
    "IsRoot": false,
    "IsActive": true,
    "SortOrdinal": null,
    "ClientId": null,
    "Tag": null
  },
  "Content": "'Based on Global Variables and SQL statements in DTS by Darren Green\n'http://www.sqldts.com/Default.aspx?205,2\nOption Explicit\n\nFunction Main()\n    Dim objDtsPack,vSQL\n\n    ' Get reference to the Exec SQL Task\n    Set objDtsPack = DTSGlobalVariables.Parent\n\n    'Delete Quiz Participant tasks:\n    vSQL = \"DELETE FROM ParticipantQuiz WHERE pID IN(\" _\n        & \"SELECT pID FROM Participant WHERE domainUserName = '\" _\n        & DTSGlobalVariables(\"ImportGroup\").Value _\n        & \"')\"\n\n    Call SetDtsSql(objDtsPack,\"DTSTask_DTSExecuteSQLTask_3\",vSQL)\n    Call SetDtsSql(objDtsPack,\"DTSTask_DTSExecuteSQLTask_6\",vSQL)\n\n    ' Clean Up\n    Set objDtsPack = Nothing\n\n    Main = DTSTaskExecResult_Success\nEnd Function\n\nSub SetDtsSql(objDtsPack,vTaskName,vSQL)\n    Dim objExecSqlTask\n    Set objExecSqlTask = objDtsPack.Tasks(CStr(vTaskName)).CustomTask\n\n    ' Assign SQL Statement to Exec SQL Task\n    objExecSqlTask.SQLStatement = vSQL\n\n    ' Clean Up\n    Set objExecSqlTask = Nothing\nEnd Sub",
  "Tag": "kb2076071706"
}