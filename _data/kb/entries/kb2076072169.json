{
  "Document": {
    "DocumentId": 2076072169,
    "Title": "Silverlight: “Silverlight Tip of the Day #60—How to load a XAML Control From a File or String”; Mike Snow",
    "DocumentShortName": null,
    "FileName": null,
    "Path": null,
    "CreateDate": "2009-08-09T21:19:00",
    "ModificationDate": "2009-08-09T21:19:00",
    "TemplateId": null,
    "SegmentId": 83,
    "IsRoot": false,
    "IsActive": true,
    "SortOrdinal": null,
    "ClientId": null,
    "Tag": null
  },
  "Content": "If you have a control written in XAML that is included in your project you can load and create it directly from file by using the method:\n\nSystem.Windows.Markup.XamlReader.Load().This method can also be used to directly create a Silverlight control from a string.\n\nTo demonstrate this I have created two functions called LoadFromXAML(). The first function takes takes as a parameter a URI that points to the XAML file in your project you want to load. The second takes as a parameter a string representation of the control.\n\npublic static object LoadFromXaml(Uri uri)\n{\n    System.Windows.Resources.StreamResourceInfo streamInfo = System.Windows.Application.GetResourceStream(uri);\n\n    if ((streamInfo != null) && (streamInfo.Stream != null))\n    {\n        using (System.IO.StreamReader reader = new System.IO.StreamReader(streamInfo.Stream))\n        {\n            return System.Windows.Markup.XamlReader.Load(reader.ReadToEnd());\n        }\n\n    }\n    return null;\n}\n\npublic static object LoadFromXamlString(string xamlControl)\n{\n    return System.Windows.Markup.XamlReader.Load(xamlControl);\n}\n\nThe above methods return a generic object that can be typecast to the object you are loading. For example:\n\n    Button myButton = (Button)LoadFromXaml(new Uri(\"/LoadXaml;component/MyButton.xaml\", UriKind.Relative));\n\n    or\n\n    string buttonXAML = \"<Button x­mlns='http://schemas.microsoft.com/client/2007' Width=\\\"100\\\" Height=\\\"100\\\" Content=\\\"Click Me\\\"></Button>\";\n\n    Button myButton = (Button) LoadFromXaml(buttonXAML);\n\nNote that in the XAML you must declare a default XML namespace as highlighted below:\n\n<Button x­mlns='http://schemas.microsoft.com/client/2007' Width=\"100\" Height=\"100\" Content=\"Click Me\"></Button>\n\nIf you do not declare this namespace, you will see the following error:\n\n    AG_E_PARSER_MISSING_DEFAULT_NAMESPACE [Line: 0 Position: 0]\n\n[http://silverlight.net/blogs/msnow/archive/2008/10/09/\n    silverlight-tip-of-the-day-60-how-to-load-a-control-straight-from-xaml.aspx]",
  "Tag": "kb2076072169"
}