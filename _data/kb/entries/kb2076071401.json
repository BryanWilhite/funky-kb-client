{
  "Document": {
    "DocumentId": 2076071401,
    "Title": "Word 2000: GetHTMLStyles()",
    "DocumentShortName": null,
    "FileName": null,
    "Path": null,
    "CreateDate": "2001-10-28T18:09:49.653",
    "ModificationDate": "2001-10-28T18:09:49.653",
    "TemplateId": null,
    "SegmentId": 76,
    "IsRoot": false,
    "IsActive": true,
    "SortOrdinal": null,
    "ClientId": null,
    "Tag": null
  },
  "Content": "Public Sub GetHTMLStyles()\n    Dim objParagraph As Word.Paragraph\n    Dim objStyle As Word.Style, blnHTMLStyleFound As Boolean\n\n    'Check for Word document with Word HTML Styles.\n    With Application\n        If .Documents.Count = 0 Then\n            Call VBA.MsgBox(\"There are no documents open to format.\")\n            Exit Sub\n        Else\n            For Each objStyle In Application.ActiveDocument.Styles\n                If objStyle.InUse And objStyle.NameLocal = \"HTML Markup\" Then\n                    blnHTMLStyleFound = True\n                    Exit For\n                End If\n            Next\n            \n            If Not (blnHTMLStyleFound) Then\n                Call VBA.MsgBox(\"Word HTML Styles are not in use in this document.\" _\n                   & VBA.Space(1) & \"Formatting cannot continue.\")\n                Exit Sub\n            End If\n            \n        End If\n    End With\n    \n    'Select all.\n    Call Application.ActiveDocument.Range.Select\n    \n    'Format all text.\n    Call HTMLFormatAll\n\n\n    'Format all headings.\n    Call HTMLFormatHeading\n    \n    'Format body (avoid Word tables).\n    For Each objParagraph In Application.ActiveDocument.Paragraphs\n        If Not (objParagraph.Style Like \"H?\") And (Application.Selection.Cells.Count = 0) Then\n            Call objParagraph.Range.Select\n            Call HTMLFormatBody\n        End If\n    Next\n    \n    Application.ActiveWindow.ActivePane.View.ShowAll = True\n    Application.Selection.HomeKey Unit:=wdStory\n    Call FindReset\n    Call VBA.MsgBox(\"Formatting complete.\")\n\nEnd Sub\n\nPrivate Sub HTMLFormatAll()\n    'Replace “ with &#8220;.\n    Call FindReset\n    With Selection.Find\n        .Forward = True\n        .Wrap = wdFindStop\n        .Format = True\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n        \n        .Text = \"“\"\n        .Replacement.Text = \"&#8220;\"\n        .Replacement.Style = ActiveDocument.Styles(\"HTML Markup\")\n        \n        Call .Execute(Replace:=wdReplaceAll)\n    End With\n\n    'Replace ” with &#8221;.\n    Call FindReset\n    With Selection.Find\n        .Forward = True\n        .Wrap = wdFindStop\n        .Format = True\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n        \n        .Text = \"”\"\n        .Replacement.Text = \"&#8221;\"\n        .Replacement.Style = ActiveDocument.Styles(\"HTML Markup\")\n        \n        Call .Execute(Replace:=wdReplaceAll)\n    End With\n\n    'Replace ‘ with &#8216;.\n    Call FindReset\n    With Selection.Find\n        .Forward = True\n        .Wrap = wdFindStop\n        .Format = True\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n        \n        .Text = \"‘\"\n        .Replacement.Text = \"&#8216;\"\n        .Replacement.Style = ActiveDocument.Styles(\"HTML Markup\")\n        \n        Call .Execute(Replace:=wdReplaceAll)\n    End With\n\n    'Replace ’ with &#8217;.\n    Call FindReset\n    With Selection.Find\n        .Forward = True\n        .Wrap = wdFindStop\n        .Format = True\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n        \n        .Text = \"’\"\n        .Replacement.Text = \"&#8217;\"\n        .Replacement.Style = ActiveDocument.Styles(\"HTML Markup\")\n        \n        Call .Execute(Replace:=wdReplaceAll)\n    End With\n\n    'Replace - with &#8212;.\n    Call FindReset\n    With Selection.Find\n        .Forward = True\n        .Wrap = wdFindStop\n        .Format = True\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n        \n        .Text = \"-\"\n        .Replacement.Text = \"&#8212;\"\n        .Replacement.Style = ActiveDocument.Styles(\"HTML Markup\")\n        \n        Call .Execute(Replace:=wdReplaceAll)\n    End With\n\n    'Replace - with &#8211;.\n    Call FindReset\n    With Selection.Find\n        .Forward = True\n        .Wrap = wdFindStop\n        .Format = True\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n        \n        .Text = \"-\"\n        .Replacement.Text = \"&#8211;\"\n        .Replacement.Style = ActiveDocument.Styles(\"HTML Markup\")\n        \n        Call .Execute(Replace:=wdReplaceAll)\n    End With\n\n    'Replace … with &#8230;.\n    Call FindReset\n    With Selection.Find\n        .Forward = True\n        .Wrap = wdFindStop\n        .Format = True\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n        \n        .Text = \"…\"\n        .Replacement.Text = \"&#8230;\"\n        .Replacement.Style = ActiveDocument.Styles(\"HTML Markup\")\n        \n        Call .Execute(Replace:=wdReplaceAll)\n    End With\n\nEnd Sub\n\nPrivate Sub HTMLFormatHeading()\n    'Replace Word .DOC Headings with Word HTML Headings.\n    Call FindReset\n    With Selection.Find\n        .Forward = True\n        .Wrap = wdFindStop\n        .Format = True\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n        \n        .Style = ActiveDocument.Styles(\"Heading 1\")\n        .Replacement.Style = ActiveDocument.Styles(\"H1\")\n        Call .Execute(Replace:=wdReplaceAll)\n    \n    End With\n\n    Call FindReset\n    With Selection.Find\n        .Forward = True\n        .Wrap = wdFindStop\n        .Format = True\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n        \n        .Style = ActiveDocument.Styles(\"Heading 2\")\n        .Replacement.Style = ActiveDocument.Styles(\"H2\")\n        Call .Execute(Replace:=wdReplaceAll)\n    \n    End With\n\n    Call FindReset\n    With Selection.Find\n        .Forward = True\n        .Wrap = wdFindStop\n        .Format = True\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n        \n        .Style = ActiveDocument.Styles(\"Heading 3\")\n        .Replacement.Style = ActiveDocument.Styles(\"H3\")\n        Call .Execute(Replace:=wdReplaceAll)\n    \n    End With\n\n    Call FindReset\n\nEnd Sub\n\nPrivate Sub HTMLFormatBody()\n    'Replace Bold formatting with Strong style.\n    Call FindReset\n    With Selection.Find\n        .Forward = True\n        .Wrap = wdFindStop\n        .Format = True\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n        \n        .Font.Bold = True\n        .Replacement.Style = ActiveDocument.Styles(\"Strong\")\n        \n        Call .Execute(Replace:=wdReplaceAll)\n    End With\n\n    'Replace Italic formatting with Emphasis style.\n    Call FindReset\n    With Selection.Find\n        .Forward = True\n        .Wrap = wdFindStop\n        .Format = True\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n        \n        .Font.Italic = True\n        .Replacement.Style = ActiveDocument.Styles(\"Emphasis\")\n        \n        Call .Execute(Replace:=wdReplaceAll)\n    End With\n\nEnd Sub\n\nPrivate Sub FindReset()\n    With Selection.Find\n        Call .ClearFormatting\n        Call .Replacement.ClearFormatting\n        .Text = vbNullString\n        .Replacement.Text = vbNullString\n    End With\nEnd Sub\n",
  "Tag": "kb2076071401"
}