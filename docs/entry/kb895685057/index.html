<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="/style.css">
    <title>Book: Level 2: Programming Visual Basic 5.0; Chapter 16 Highlights (2/3): Managing Data with Data Access Objects - the funky knowledge base</title>
</head>
<body>
    <h1>the funky knowledge base</h1>
    <h2>personal notes from way, _way_ back and maybe today</h2>

<section class="entry">
    <h3>Book: Level 2: Programming Visual Basic 5.0; Chapter 16 Highlights (2/3): Managing Data with Data Access Objects</h3>

<pre>
<p>Using the MoveLast Method to Count Number of Rows</p>
<p>Since the RecordCount property only returns the number of rows accessed, we need to use the MoveLast method of the Recordset object to access all of the records. By moving to the last record in the record set, RecordCount will store the number of rows in the entire record set.</p>
<p>Using MS-SQL to Count Number of Rows</p>
<p>Moving to the last record in a recordset may take significantly longer than executing a dynamic MS-SQL query against the Database object. If this is the case, MS-SQL can be used to count the number of records. This is one form:</p>
<pre><code>m_strSQL = &amp;quot;SELECT Count (*) As RecCount &amp;quot; _
                    &amp; &amp;quot;FROM tblMytable&amp;quot;
Set m_rsDAO = m_dbDAO.OpenRecordset(m_strSQL)

g_varReturn = m_rsDAO.Fields(&amp;quot;RecCount&amp;quot;)
</code></pre>
<p>where g_varReturn is a Public variant variable that will not generate a runtime error if the Fields property returns Null. In the above example, Null will never be returned but it is better to be safe than sorry!</p>
<p>More Use of MS-SQL Strings</p>
<p>Please see pages 16-17 to 16-19 for more ways to use MS-SQL strings.</p>
<p>Using the FindFirst and FindNext Methods to Find Data</p>
<p>The FindFirst and FindNext methods can be used to find all of the data in a given set of records. Below is a code fragment that finds the first order date for CustomerID =100 and then continues through the recordset until all order dates are found:</p>
<pre><code>strCriteria = &amp;quot;CustomerID = 100&amp;quot;
With m_rsDAO
    .FindFirst strCriteria
    strList = .Fields(&amp;quot;OrderDate&amp;quot;)
    Do Until .NoMatch
        strList = strList &amp; vbNewLine &amp; .Fields(&amp;quot;OrderDate&amp;quot;)
        .FindNext strCriteria
    Loop
End With
</code></pre>
<p>The Boolean NoMatch property of the Recordset object makes up the Do...Loop condition.</p>
<p>General Form for Modifying Data</p>
<p>Use the Edit and Update methods to change data in a Recordset:</p>
<pre><code>With m_rsDAO
    .Edit
    .Fields(&amp;quot;MyField&amp;quot;) = &amp;quot;Some new string value.&amp;quot;
    .Update
End With
</code></pre>
<p>Note that omitting Update and then moving off of the row will cause data to be lost.</p>

</pre>

    <span class="date"> <strong>mod date:</strong> 10/1/1998 1:40:23 PM </span>
</section>


<footer>
        &copy; 2019 Bryan D. Wilhite
        <a href="https://twitter.com/BryanWilhite">@BryanWilhite</a>
</footer>
</body>
</html>