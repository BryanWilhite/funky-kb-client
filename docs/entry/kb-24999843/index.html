<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="/style.css">
    <title>Code: Procedure That Reads in a Text File and Updates the SysCmd() Progress Meter;basReadTextFile() - the funky knowledge base</title>
</head>
<body>
    <h1>the funky knowledge base</h1>
    <h2>personal notes from way, _way_ back and maybe today</h2>

<section class="entry">
    <h3>Code: Procedure That Reads in a Text File and Updates the SysCmd() Progress Meter;basReadTextFile()</h3>

<pre>
<p>Private Sub basReadTextFile()
'
'This sub reads a text file line by line.
'It updates the progress meter as it reads the file.
'The LOF() function is used as the known value
'the progress meter refers to. The lineCounter variable
'stores the total number of characters in the file.
'The theory is that the total number of characters
'in a text file (including carriage returns) equals
'the value in bytes returned by LOF().
'
'Recall that 1 character is equal to 1 byte (8 bits).
'
Dim varReturn As Variant
Dim lngCounter As Long
Dim strData As String
'
'Note that varReturn is of datatype Variant since
'SysCmd() returns numerical values (error values)
'and the Null (indicating successful execution).
'lngCounter is of datatype Long; its maximum
' positive range is 2,147,483,647 which
'implies that it can be used to read files as
'large as 2 GB.
'
Open &quot;c:\\windows\\desktop\\pine_addressbook.txt&quot; _
For Input Access Read As #1</p>
<pre><code>varReturn = Application.SysCmd(acSysCmdInitMeter, _
    &amp;quot;Reading File...&amp;quot;, VBA.LOF(1))

Do Until VBA.EOF(1)
    Line Input #1, strData
    varReturn = Application.SysCmd(acSysCmdUpdateMeter, _
        lngCounter)
    lngCounter = VBA.Len(lineData) + lngCounter + 2
    '
    'We add 2 to lngCounter to account for the length
    'of a carriage return: VBA.Len(vbCrLf) = 2
    'where vbCrLf is sequentially ASCII char's 13 and 10.
    '
Loop

varReturn = Application.SysCmd(acSysCmdRemoveMeter)

Close #1
</code></pre>
<p>End Sub</p>

</pre>

    <span class="date"> <strong>mod date:</strong> 9/9/1999 3:45:46 PM </span>
</section>


<footer>
        &copy; 2019 Bryan D. Wilhite
        <a href="https://twitter.com/BryanWilhite">@BryanWilhite</a>
</footer>
</body>
</html>