<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="/style.css">
    <title>Windows Forms Databinding: Andrew Brust on the Importance of the EndCurrentEdit() Method; DotNetRocks!; RowJiggle() Hack; VB.NET; C# - the funky knowledge base</title>
</head>
<body>
    <h1>the funky knowledge base</h1>
    <h2>personal notes from way, _way_ back and maybe today</h2>

<section class="entry">
    <h3>Windows Forms Databinding: Andrew Brust on the Importance of the EndCurrentEdit() Method; DotNetRocks!; RowJiggle() Hack; VB.NET; C#</h3>

<pre>
<p>The last 10 minutes of the Franklins.net DotNetRocks! show with Andrew Brust on March 31, 2003 deals with a data binding &quot;bug&quot; that's actually a feature. Here's the feature: when you open a Windows Form and enter data into a TextBox or ComboBox control bound to a DataSet and then close the form without moving to a new record or pressing some kind of Save button you will lose your changes.</p>
<p>This wonderful feature of the .NET Framework was stumbled upon by me while building my first WinForms project. In a fit of rage and panic, I wrote this code:</p>
<pre><code>Public Sub RowJiggle(ByRef BindContext As BindingContext, _
    ByRef TargetDataView As DataView)
    'This subroutine makes sure that changes are recognized
    'by moving off the row being edited and moving back. This hack sucks.
    With BindContext(TargetDataView)
        Try
            If .Count &amp;gt; 1 Then
                If .Position &amp;lt;= (.Count - 1) And .Position &amp;gt; 0 Then
                    'Backward jiggle:
                    .Position -= 1
                    .Position += 1
                ElseIf .Position &amp;lt; (.Count - 1) And .Position = 0 Then
                    'Forward jiggle:
                    .Position += 1
                    .Position -= 1
                End If
            End If
        Catch Ex As Exception
            Call Me.SetStatusBar(StatusIcons.ClientError, MainMsg:=Ex.Message)
            Call MessageBox.Show(Ex.Message)
        End Try
    End With
End Sub
</code></pre>
<p>Unfortunately, this code will not work for a DataSet with one row. Fortunately, that DotNetRocks! show aforementioned was archived and listened to again. This private rebroadcast of the show inspired me to write this code:</p>
<pre><code>Private Sub RowEndEdit(ByRef BindContext As BindingContext, _
    ByRef TargetDataView As DataView)

    Dim BindBase As BindingManagerBase
    Try
        BindBase = BindContext.Item(TargetDataView)
        Call BindBase.EndCurrentEdit()

    Catch ex As Exception
        Call Me.SetStatusBar(StatusIcons.ClientError, MainMsg:=ex.Message)
        Call MessageBox.Show(ex.Message)
    End Try
End Sub
</code></pre>
<p>This code rocks!</p>

</pre>

    <span class="date"> <strong>mod date:</strong> 6/29/2004 8:57:14 PM </span>
</section>


<footer>
        &copy; 2019 Bryan D. Wilhite
        <a href="https://twitter.com/BryanWilhite">@BryanWilhite</a>
</footer>
</body>
</html>