<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
        <meta name="description" content="This repo stores in static files notes taken since the 1990s. I started taking notes in Microsoft Access, then I built an ASP site over SQL server, then I built a PHP site over SQLite, then I built an Angular JS site over Azure Storage BLOBs." />
        <meta name="robots" content="index, follow" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <base href="/" />

        <link rel="canonical" href="http://the-funky-knowledge-base.github.io/" />
        <link rel="icon" type="image/x-icon" href="./images/favicon.ico" />
        <link rel="stylesheet" href="./index.min.css" />
        <script src="./index.min.js"></script>

        <title>The Differences among Empty, Nothing, vbNull, vbNullChar, vbNullString and the Zero-Length String - the funky knowledge base</title>
    </head>

    <body class="mdc-typography">
        <h1>the funky knowledge base</h1>
        <h2>personal notes from way, _way_ back and maybe today</h2>
        <main>
<section class="entry">
    <h3>The Differences among Empty, Nothing, vbNull, vbNullChar, vbNullString and the Zero-Length String</h3>

<pre>
<p>Back in the days of VB 5.0, Keith Pleas in &quot;Avoid Programming Pitfalls&quot; (currently at http://msdn.microsoft.com/library/periodic/period98/kp0398.htm) writes:</p>
<p>[begin quote]</p>
<p>To keep from being embarrassed, you should know these terms:</p>
<p>&quot;&quot;: A zero-length string (commonly called an &quot;empty string&quot;) is technically a zero-length BSTR that actually uses six bytes of memory. In general, you should use the constant vbNullString instead, particularly when calling external DLL procedures.</p>
<p>Empty: A variant of VarType 0 (vbEmpty) that has not yet been initialized. Test whether it is &quot;nil&quot; using the IsEmpty function.</p>
<p>Nothing: Destroys an object reference using the Set statement. Test whether it is &quot;nil&quot; using the Is operator:</p>
<p>If obj Is Nothing Then...</p>
<p>Null: A variant of VarType 1 (vbNull) that means &quot;no valid data&quot; and generally indicates a database field with no value. Don't confuse this with a C NULL, which indicates zero. Test whether it is &quot;nil&quot; using the IsNull function.</p>
<p>vbNullChar: A character having a value of zero. It is commonly used for adding a C NULL to a string or for filling a fixed-length string with zeroes:</p>
<p>Path = String(255, vbNullChar)</p>
<p>vbNullString: A string having a value of zero, such as a C NULL, that takes no memory. Use this string for calling external procedures looking for a null pointer to a string. To distinguish between vbNullString and &quot;&quot;, use the VBA StrPtr function: StrPtr(vbNullString) is zero, while StrPtr(&quot;&quot;) is a nonzero memory address. [Note: the StrPtr() function may not be a part of the VBA members shown in the Object Browser so it will not AutoComplete. Enter the following line in the Immediate Window to determine if this function is available: ?StrPtr(vbNullString). This should return 0 immediately.]</p>
<p>[end quote]</p>
<p>From the above I draw the following conclusions: The Zero-length string is old-fashioned and used for backward compatibility with previous versions of VB; use of vbNullString is recommended. The Empty string should be used in statements with Variants. The Nothing keyword should be used in statements with object variables. The vbNull constant is used to determine if a Variant contains Null via the VarType() function; this is used in procedures involving database result sets. The vbNullChar and vbNullString constants are primarily for communicating with APIs written in C or C++.</p>
<p>For more information please see MSDN library article &quot;The meaning of zero&quot; (http://msdn.microsoft.com/library/books/advnvb5/Ch07_31.htm).</p>

</pre>

    <span class="date"> <strong>mod date:</strong> 3/1/2000 7:31:45 PM </span>
</section>

        </main>

        <footer>
            &copy; 2019 Bryan D. Wilhite
            <a href="https://twitter.com/BryanWilhite">@BryanWilhite</a>
        </footer>
    </body>

</html>