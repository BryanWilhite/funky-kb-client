<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
        <meta name="description" content="This repo stores in static files notes taken since the 1990s. I started taking notes in Microsoft Access, then I built an ASP site over SQL server, then I built a PHP site over SQLite, then I built an Angular JS site over Azure Storage BLOBs." />
        <meta name="robots" content="index, follow" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <base href="/" />

        <link rel="canonical" href="http://the-funky-knowledge-base.github.io/" />
        <link rel="icon" type="image/x-icon" href="./images/favicon.ico" />
        <link rel="stylesheet" href="./index.min.css" />
        <script src="./index.min.js"></script>

        <title>Book: Level 2: Programming Visual Basic 5.0; Chapter 16 Highlights (3/3): Managing Data with Data Access Objects - the funky knowledge base</title>
    </head>

    <body class="mdc-typography">
        <h1>the funky knowledge base</h1>
        <h2>personal notes from way, _way_ back and maybe today</h2>
        <main>
<section class="entry">
    <h3>Book: Level 2: Programming Visual Basic 5.0; Chapter 16 Highlights (3/3): Managing Data with Data Access Objects</h3>

<pre>
<p>General Form for Deleting Data</p>
<p>This With and Do...Loop structure can be used to scan a recordset and delete records using the Delete method:</p>
<pre><code>With rsDAO
    .FindFirst strCriteria
    Do Until .NoMatch
        .Delete
        .FindNext strCriteria
    Loop
End With
</code></pre>
<p>where strCriteria is a string containing the specified deletion criteria.</p>
<p>General Form for Inserting Rows</p>
<p>Use the AddNew method to insert a new row:</p>
<pre><code>With m_rsDAO
    .AddNew
    .Fields(&amp;quot;MyField&amp;quot;) = &amp;quot;Some new string value.&amp;quot;
    'More fields can be specified. Nulls will be inserted
    'in unspecified fields or an error will be generated
    'if the Required property is set to True for any field
    'not assigned a value here.
    .Update
End With
</code></pre>
<p>Note that omitting Update and then moving off of the row will cause data to be lost.</p>
<p>Creating Query Definitions</p>
<p>Appending a compiled query to the QueryDefs collection should be done when the query (even is if is a parameter query) needs to be built on the fly and run several times. This will increase application performance. For more information see the CreateQueryDef method in Microsoft's DAO reference.</p>
<p>Referencing Stored Queries</p>
<p>If the query does not need to be built on the fly then use the QDE grid in Access 97 to design and store the query. Now the general form for referencing and opening a stored SELECT query without parameters is:</p>
<pre><code>'Set the module-level QueryDef type variable m_qdDAO.
Set m_qdDAO = m_dbDAO.QueryDefs(&amp;quot;MyStoredQry&amp;quot;)

'Now open a recordset based on the query.
Set m_rsDAO = m_qdDAO.OpenRecordset()
</code></pre>
<p>The general form for referring to and running a stored action query is:</p>
<pre><code>Set m_qdDAO = m_dbDAO.QueryDefs(&amp;quot;MyStoredQry&amp;quot;)
m_qdDAO.Execute
</code></pre>
<p>Recall that the style here is to use module-level variables and share them among the procedures in the module where logically possible. This requires that these variables be set to nothing after the procedure runs where logically possible.</p>

</pre>

    <span class="date"> <strong>mod date:</strong> 1998-10-01T20:40:39.000Z </span>
</section>

        </main>

        <footer>
            &copy; 2019 Bryan D. Wilhite
            <a href="https://twitter.com/BryanWilhite">@BryanWilhite</a>
        </footer>
    </body>

</html>