<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="/style.css">
    <title>VBA Code: Batch Conversion of Files into WordPerfect Format - the funky knowledge base</title>
</head>
<body>
    <h1>the funky knowledge base</h1>
    <h2>personal notes from way, _way_ back and maybe today</h2>

<section class="entry">
    <h3>VBA Code: Batch Conversion of Files into WordPerfect Format</h3>

<pre>
<p>Sub SaveFolder()
Dim FSO As New FileSystemObject
Dim Folder As Folder
Dim File As File
Set Folder = FSO.GetFolder(&quot;C:\\MyDocs\\&quot;)
For Each File In Folder.Files
If InStr(1, File.Name, &quot;.wps&quot;) Then _
Call FileSaveAs(Folder.Path &amp; &quot;\\&quot;, File.Name, &quot;.wps&quot;)
Next
End Sub</p>
<p>Sub FileSaveAs(DirName As String, FileName As String, Extension As String)</p>
<pre><code>ChangeFileOpenDirectory DirName

Documents.Open _
    FileName:=&amp;quot;&amp;quot;&amp;quot;&amp;quot; &amp; FileName &amp; &amp;quot;&amp;quot;&amp;quot;&amp;quot;, _
    ConfirmConversions:=False, _
    ReadOnly:=False, _
    AddToRecentFiles:=False, _
    PasswordDocument:=&amp;quot;&amp;quot;, _
    PasswordTemplate:=&amp;quot;&amp;quot;, _
    Revert:=False, _
    WritePasswordDocument:=&amp;quot;&amp;quot;, _
    WritePasswordTemplate:=&amp;quot;&amp;quot;, _
    Format:=wdOpenFormatAuto

'The ActiveDocument.SaveAs() method is hard-coded to format 112.
'Use the Application.FileConverters.Item(&amp;quot;&amp;lt;Index&amp;gt;&amp;quot;).SaveFormat property
'for other file formats and a more generic design.
'
ActiveDocument.SaveAs _
    FileName:=DirName &amp; Replace(FileName, Extension, &amp;quot;.doc&amp;quot;), _
    FileFormat:=112, _
    LockComments:=False, _
    Password:=&amp;quot;&amp;quot;, _
    AddToRecentFiles:= _
    True, WritePassword:=&amp;quot;&amp;quot;, _
    ReadOnlyRecommended:=False, _
    EmbedTrueTypeFonts:=False, _
    SaveNativePictureFormat:=False, _
    SaveFormsData:=False, _
    SaveAsAOCELetter:=False

ActiveDocument.Close
</code></pre>
<p>End Sub</p>

</pre>

    <span class="date"> <strong>mod date:</strong> 8/26/2004 1:37:45 PM </span>
</section>


<footer>
        &copy; 2019 Bryan D. Wilhite
        <a href="https://twitter.com/BryanWilhite">@BryanWilhite</a>
</footer>
</body>
</html>