<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>IIS: Flippant Remarks about the SQL Server ADO Error &quot;Login failed for user 'NT AUTHORITY&bsol;&bsol;ANONYMOUS LOGON'&quot; and Active Directory
 - the funky knowledge base</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>


<p>If I ever want to know why someone would be &quot;forced&quot; to upgrade their Windows-based enterprise to Active Directory, all I have to do is try to programmatically connect to SQL Server from an ASP page that disallows anonymous access. IIS does not send logon credentials (other than its own Anonymous Access User) to a SQL Server on another server without Active Directory installed and Security Account Delegation enabled.</p>
<p>Everything works fine as long as I have IIS and SQL server on the same machine but as soon these two are separated I begin to pine for Active Directory. I say this even though there is a workaround suggested in &quot;INF: Authentication Methods for Connections to SQL Server in Active Server Pages&quot; (Q247931) and &quot;PRB: 'Client Unable to Establish Connection' Error Message When Connecting from ASP to SQL Server&quot; (Q253500). However, this workaround (featuring Basic Authentication and the wonderful, clear text password) leaves unacceptable security holes. No, the only way to go is via Active Directory.</p>
<p>The Active Directory resolution is the same one specified in &quot;ACC2002: &quot;Login Failed for User 'NT AUTHORITY\\ANONYMOUS LOGON'.&quot; Error When You Try to Link a Table&quot; (Q295255). I have yet to try it so I'll get back to these flippant remarks later.</p>


<footer>
    &copy; 2019 the funky knowledge base
</footer>
</body>
</html>