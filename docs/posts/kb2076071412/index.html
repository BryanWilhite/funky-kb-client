<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>VB Script and ASP Code: basCriteria(); Building Dynamic HTML Based on Variable Form Input - the funky knowledge base</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>


<p>Function basCriteria(vSQL,vDBField,vComparison,vFormValue,vDataType)
'Based on http://15seconds.com/issue/010629.htm.</p>
<pre><code>Dim vValue,vArrayVal,vArray,vClauseStyle,vConnector
Dim vWildCard,vStrChar
    
'ADO overrides the Microsoft Access MS-SQL wildcard ('*') and text delimiter (&amp;quot;):
vWildCard = &amp;quot;%&amp;quot;
vStrChar = Chr(39)

basCriteria = vSQL
vValue = vFormValue
If Len(vValue) = 0 then Exit Function 

vComparison = Trim(vComparison)
vDataType = Trim(vDataType)
vClauseStyle = Ucase(vComparison &amp; &amp;quot;:&amp;quot; &amp; vDataType)
      
Select Case vClauseStyle
Case &amp;quot;=:CHR&amp;quot;
    vValue = vStrChar &amp; Replace(vValue,vStrChar,vStrChar &amp; vStrChar) &amp; vStrChar
          
Case &amp;quot;=:NUM&amp;quot;, &amp;quot;&amp;gt;:NUM&amp;quot;, &amp;quot;&amp;lt;:NUM&amp;quot;
    If (Not IsNumeric(vValue)) Then vValue = 0
          
Case &amp;quot;IN:CHR&amp;quot;
    vValue=Replace(vValue,&amp;quot;, &amp;quot;,&amp;quot;,&amp;quot;)
    vValue=Replace(vValue,vStrChar,vStrChar &amp; vStrChar)
    vValue=&amp;quot;(&amp;quot; &amp; vStrChar &amp; Replace(vValue,&amp;quot;,&amp;quot;,vStrChar &amp; &amp;quot;,&amp;quot; &amp; vStrChar) &amp; vStrChar &amp; &amp;quot;)&amp;quot;
      
Case &amp;quot;IN:NUM&amp;quot;
    vValue=&amp;quot;&amp;quot;
    For Each vArrayVal In vArray
      If IsNumeric(vArrayVal) Then vValue = vValue &amp; &amp;quot;,&amp;quot; &amp; Trim(vArrayVal)
    Next

    If Len(vValue) &amp;lt; 2 Then Exit Function 
    vValue = Mid(vValue,2) 'Remove leading comma.
    vValue = &amp;quot;(&amp;quot; &amp; vValue &amp; &amp;quot;)&amp;quot;
                  
Case &amp;quot;*:CHR&amp;quot; 'Containing:
    vComparison = &amp;quot; LIKE &amp;quot;
    vValue = vStrChar &amp; vWildCard &amp; Replace(vValue,vStrChar,vStrChar &amp; vStrChar) &amp; vWildCard &amp; vStrChar

Case &amp;quot;=*:CHR&amp;quot; 'Starting with:
    vComparison = &amp;quot; LIKE &amp;quot;
    vValue = vStrChar &amp; vWildCard &amp; Replace(vValue,vStrChar,vStrChar &amp; vStrChar) &amp; vStrChar

Case &amp;quot;*=:CHR&amp;quot; 'Ending with:
    vComparison = &amp;quot; LIKE &amp;quot;
    vValue = vStrChar &amp; Replace(vValue,vStrChar,vStrChar &amp; vStrChar) &amp; vWildCard &amp; vStrChar

Case Else
    Err.Raise 1,&amp;quot;Function basCriteria&amp;quot;, _
        (&amp;quot;Missing case for '&amp;quot; &amp; vClauseStyle &amp; &amp;quot;'&amp;quot;)
End Select

vConnector=&amp;quot; WHERE &amp;quot; 'For first criterion only.
If 0 &amp;lt; Instr(1,vSQL,&amp;quot;WHERE&amp;quot;) Then vConnector = &amp;quot; AND &amp;quot; 

basCriteria = vSQL &amp; vConnector &amp; vDBField &amp; vComparison &amp; vValue          
</code></pre>
<p>End Function</p>


<footer>
    &copy; 2019 the funky knowledge base
</footer>
</body>
</html>