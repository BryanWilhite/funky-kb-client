<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>PROBLEM: the Default Instance of a Form Is Not Found - the funky knowledge base</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>


<p>If the default instance of a form is not found, this most likely means that it does not have a Class Module. For example, suppose you have two forms in a database, frmMain and fsubOther, where frmMain has a module and fsubOther does not. Also suppose that this database has no user-defined classes. In this example, only one class (besides globals) will appear in the Object Browser for the Project/Library defined for the current database. This class will be called Form_frmMain.</p>
<p>This implies that fsubOther cannot be manipulated programmatically. Any attempts to manipulate fsubOther directly will generate run-time errors. If, however, fsubOther is a sub-form of frmMain then it can be manipulated through code. Suppose that the Name property of the Sub Form is fsubOther. We can make sure its FilterOn property is False with the line</p>
<pre><code>Form_frmMain.fsubOther.Form.FilterOn = False
</code></pre>
<p>We now can use the Form property of the Sub Form object to manipulate fsubOther. Note that there are some limitations: the most glaring constraint is need to use the Controls collection to refer to the sub-form controls. For example, the following code incorrectly attempts to refer to the ControlSource property of the Text Box txt1 on fsubOther:</p>
<pre><code>'This is incorrect:
With Form_frmMain
    .fsubOther.Form.txt1.ControlSource = &amp;quot;[Fname]&amp;quot;
End With
</code></pre>
<p>In this example, we can only refer to txt1 via the Controls collection with the lines</p>
<pre><code>'This is correct:
With Form_frmMain
    .fsubOther.Form.Controls(&amp;quot;txt1&amp;quot;).ControlSource = &amp;quot;[Fname]&amp;quot;
End With
</code></pre>
<p>Note that VBA does not &quot;know&quot; whether this particular member of the Controls collection has a ControlSource property. The use of the Controls collection may noticeably reduce performance due to late-binding issues. If this is the case simply set the Has Module property of the form to Yes and refer to the default instance of the form directly.</p>


<footer>
    &copy; 2019 the funky knowledge base
</footer>
</body>
</html>